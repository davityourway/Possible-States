from typing import List, Tuple, Dict
import csv
import pandas
import matplotlib.pyplot as plt

nonterm_prop = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9999999333333334, 0.9999998666666666, 0.9999992666666667, 0.9999982, 0.9999960666666666, 0.9999942666666667, 0.9999903333333333, 0.9999856, 0.9999774, 0.9999693333333334, 0.9999541333333334, 0.9999389333333333, 0.9999132666666667, 0.9998903333333333, 0.9998506666666667, 0.9998129333333333, 0.9997536666666667, 0.9996915333333334, 0.9996065333333334, 0.9995242, 0.9994100666666667, 0.9992952666666667, 0.999136, 0.9989774, 0.9987669333333333, 0.9985564666666666, 0.9982801333333333, 0.998001, 0.9976450666666666, 0.9972894, 0.9968504, 0.9964037333333333, 0.9958395333333333, 0.9952814666666666, 0.9945875333333334, 0.9939078, 0.9930836666666667, 0.9922647333333333, 0.9912767333333333, 0.9902737333333334, 0.9890862, 0.9879047333333333, 0.9865038666666667, 0.9851023333333333, 0.9834694666666667, 0.9818322666666667, 0.9799125333333333, 0.9779944666666667, 0.9758003333333334, 0.9735812666666667, 0.9710544666666666, 0.9685532666666666, 0.9656596, 0.962773, 0.9595042666666667, 0.9562251333333334, 0.9524922666666666, 0.94875, 0.9445892, 0.940427, 0.9357676666666667, 0.9310931333333333, 0.9259093333333334, 0.9207428666666667, 0.9149966666666667, 0.909293, 0.9029787333333333, 0.8966767333333333, 0.8897255333333334, 0.882854, 0.8752744, 0.8678255333333333, 0.8595627333333333, 0.8514404, 0.8425432, 0.8337262, 0.8242097333333334, 0.8147812666666666, 0.8045381333333333, 0.7944450666666667, 0.7835828666666667, 0.7727806666666667, 0.7611960666666666, 0.7497758666666666, 0.7375170666666667, 0.7255066, 0.7126298, 0.6999204666666666, 0.6864585333333333, 0.6732596666666667, 0.6592656, 0.645524, 0.6310034, 0.6168402, 0.6018034666666666, 0.5871931333333333, 0.571779, 0.5568956666666667, 0.5412032, 0.5259722, 0.5100953333333333, 0.49468046666666665, 0.47864853333333335, 0.46317813333333335, 0.44714013333333336, 0.4316542666666667, 0.4156422, 0.4002270666666667, 0.3844013333333333, 0.3691796666666667, 0.35357, 0.3386308, 0.3234098, 0.3088769333333333, 0.29408693333333336, 0.280035, 0.2658064, 0.25229073333333335, 0.23868233333333333, 0.2257882, 0.21290333333333333, 0.2007382, 0.18853373333333334, 0.17710466666666666, 0.16577226666666667, 0.15513253333333332, 0.1445798, 0.13477206666666666, 0.1251026, 0.1161142, 0.10734506666666667, 0.099271, 0.09136466666666666, 0.08408893333333334, 0.07703326666666667, 0.07053466666666666, 0.0643272, 0.058625333333333335, 0.053189, 0.04823126666666667, 0.043555333333333335, 0.03932373333333333, 0.0353074, 0.0316952, 0.028286933333333333, 0.025245866666666665, 0.0223996, 0.019867933333333334, 0.0175352, 0.015453733333333334, 0.013535, 0.011860066666666667, 0.0103126, 0.008976, 0.0077728, 0.0067212, 0.005776866666666667, 0.0049574, 0.0042224666666666666, 0.0036094, 0.0030573333333333333, 0.0025818, 0.0021675333333333333, 0.0018241333333333333, 0.0015216666666666666, 0.0012702, 0.0010554, 0.0008670666666666666, 0.0007104666666666666, 0.0005824666666666667, 0.0004715333333333333, 0.0003848666666666667, 0.000312, 0.0002482, 0.00019746666666666668, 0.00015513333333333333, 0.00012206666666666666, 9.62e-05, 7.526666666666666e-05, 5.9533333333333335e-05, 4.56e-05, 3.506666666666667e-05, 2.66e-05, 1.9333333333333333e-05, 1.52e-05, 1.12e-05, 8.333333333333334e-06, 5.733333333333333e-06, 3.9333333333333335e-06, 3e-06, 1.933333333333333e-06, 1.4666666666666667e-06, 1.0666666666666667e-06, 6e-07, 2e-07, 6.666666666666667e-08, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
term_prop = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.666666666666667e-08, 6.666666666666667e-08, 6.666666666666667e-07, 1.1333333333333334e-06, 2.8e-06, 2.9333333333333333e-06, 6.733333333333333e-06, 7.666666666666667e-06, 1.4933333333333333e-05, 1.5733333333333334e-05, 3.013333333333333e-05, 3.093333333333333e-05, 5.58e-05, 5.3866666666666664e-05, 9.546666666666667e-05, 9.16e-05, 0.00015473333333333334, 0.00015366666666666667, 0.00023973333333333332, 0.000236, 0.0003538666666666667, 0.00035066666666666666, 0.0005129333333333333, 0.0005092, 0.0007233333333333333, 0.0007196, 0.0009995333333333333, 0.0009984666666666667, 0.001355, 0.0013538666666666668, 0.0017934, 0.0017994, 0.0023568666666666667, 0.0023559333333333333, 0.0030490666666666668, 0.0030332, 0.0038698, 0.003847933333333333, 0.004853333333333334, 0.0048462, 0.0060337333333333335, 0.006019266666666667, 0.0074232, 0.0074086, 0.009040266666666666, 0.009029, 0.010938933333333333, 0.010921933333333333, 0.013099133333333334, 0.013103466666666667, 0.0155824, 0.015555133333333334, 0.018411466666666668, 0.018371333333333333, 0.021592466666666667, 0.0215594, 0.025203933333333334, 0.025176333333333332, 0.029207933333333335, 0.029170933333333333, 0.03366266666666667, 0.033624933333333336, 0.038573333333333334, 0.03850186666666667, 0.043964133333333336, 0.043829733333333336, 0.049830733333333335, 0.049665, 0.0562058, 0.055929, 0.0630634, 0.0626236, 0.07042793333333333, 0.06979693333333334, 0.0782136, 0.07744293333333334, 0.08636526666666666, 0.08542946666666666, 0.09493306666666666, 0.0937662, 0.10375886666666667, 0.10246106666666667, 0.112914, 0.11136026666666667, 0.1223076, 0.12038393333333333, 0.13176006666666668, 0.12954173333333333, 0.141173, 0.13860153333333333, 0.15046573333333332, 0.14750593333333334, 0.1595724, 0.15606633333333333, 0.1683818, 0.16431353333333334, 0.1766864, 0.17194686666666667, 0.18434453333333334, 0.17897186666666667, 0.1911364, 0.1851622, 0.19705933333333334, 0.1904248, 0.2018462, 0.19461513333333333, 0.20551333333333333, 0.19764566666666666, 0.2078878, 0.1994416, 0.2089216, 0.1999018, 0.20853866666666668, 0.19896406666666666, 0.2066494, 0.19659646666666666, 0.20329646666666668, 0.1928454, 0.1985054, 0.1877154, 0.192367, 0.1811912, 0.18500066666666667, 0.17354253333333333, 0.17635326666666667, 0.1648388, 0.16676813333333335, 0.155181, 0.15623366666666666, 0.14480793333333333, 0.14502853333333332, 0.13385866666666665, 0.13340386666666668, 0.12254606666666666, 0.1214876, 0.11110113333333334, 0.10952833333333334, 0.09971133333333333, 0.0977036, 0.08855413333333334, 0.08623426666666667, 0.07774306666666667, 0.07528006666666667, 0.06753246666666667, 0.06496393333333333, 0.0579756, 0.055372866666666666, 0.04911346666666667, 0.04656213333333333, 0.04109246666666667, 0.038733, 0.03392866666666667, 0.03181406666666667, 0.0276768, 0.025700533333333334, 0.022238133333333333, 0.020511466666666665, 0.017641066666666667, 0.016119266666666666, 0.013770266666666666, 0.012486933333333334, 0.0105948, 0.009510533333333333, 0.008003, 0.007148466666666666, 0.005947266666666667, 0.0052719333333333335, 0.004378866666666667, 0.0038223333333333334, 0.0031406666666666666, 0.0027294, 0.0022178666666666665, 0.0019017333333333332, 0.0015387333333333334, 0.0013092, 0.0010477333333333333, 0.0008820666666666667, 0.0006998, 0.0005799333333333333, 0.0004581333333333333, 0.0003772, 0.0002902, 0.00024093333333333333, 0.00018313333333333333, 0.00014993333333333334, 0.00011093333333333334, 9.253333333333334e-05, 6.94e-05, 5.4266666666666667e-05, 4.073333333333333e-05, 3.08e-05, 2.3066666666666667e-05, 1.7333333333333332e-05, 1.3866666666666667e-05, 9.066666666666667e-06, 7e-06, 4.8e-06, 3.9333333333333335e-06, 2e-06, 2.0666666666666666e-06, 1.1333333333333334e-06, 1.1333333333333334e-06, 6e-07, 7.333333333333333e-07, 2e-07, 3.3333333333333335e-07, 6.666666666666667e-08, 2e-07, 6.666666666666667e-08, 2e-07, 6.666666666666667e-08, 6.666666666666667e-08, 0.0, 6.666666666666667e-08, 0.0, 6.666666666666667e-08, 0.0]
illegal_prop = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.666666666666667e-08, 6.666666666666667e-08, 6.666666666666667e-07, 1.1333333333333334e-06, 2.8e-06, 2.9333333333333333e-06, 6.733333333333333e-06, 7.666666666666667e-06, 1.4933333333333333e-05, 1.5733333333333334e-05, 3.013333333333333e-05, 3.093333333333333e-05, 5.58e-05, 5.3866666666666664e-05, 9.546666666666667e-05, 9.16e-05, 0.0001548, 0.00015373333333333332, 0.0002398, 0.00023606666666666667, 0.0003540666666666667, 0.00035106666666666667, 0.0005134, 0.0005097333333333333, 0.0007239333333333333, 0.0007203333333333334, 0.0010005333333333334, 0.0009999333333333333, 0.0013567333333333333, 0.0013562, 0.0017968666666666666, 0.0018036, 0.0023626, 0.0023634, 0.003059, 0.0030465333333333333, 0.0038873333333333334, 0.0038699333333333335, 0.004880066666666667, 0.004880066666666667, 0.006076, 0.006072933333333333, 0.007489066666666666, 0.007490266666666667, 0.009138733333333333, 0.009148533333333334, 0.0110836, 0.011100533333333334, 0.013315266666666667, 0.013363133333333334, 0.0158916, 0.015928933333333332, 0.018855666666666666, 0.018903266666666668, 0.022215466666666666, 0.0223038, 0.026073666666666665, 0.026202866666666668, 0.030402066666666668, 0.030569666666666665, 0.035281933333333335, 0.03551733333333333, 0.040755266666666665, 0.0410392, 0.04687726666666667, 0.04719053333333333, 0.05365826666666667, 0.05406866666666667, 0.061217, 0.0616622, 0.06955086666666667, 0.07000933333333334, 0.07876266666666666, 0.0792432, 0.08883086666666666, 0.089425, 0.09978926666666667, 0.1005288, 0.11178873333333333, 0.11265826666666667, 0.12475826666666667, 0.12588993333333334, 0.13886386666666667, 0.14017533333333335, 0.15410946666666667, 0.15561013333333334, 0.1705378, 0.17236846666666666, 0.1881388, 0.19026866666666667, 0.20697006666666667, 0.2094242, 0.22709346666666666, 0.22981473333333333, 0.24849333333333334, 0.2515346, 0.2711574666666667, 0.27445226666666667, 0.29505593333333335, 0.29876826666666667, 0.32015733333333335, 0.32429213333333334, 0.34639706666666664, 0.35101366666666667, 0.3737306, 0.37884446666666666, 0.40212726666666665, 0.40771086666666667, 0.4313787333333333, 0.4375084, 0.4614674, 0.4680515333333333, 0.492159, 0.49926366666666666, 0.5233685333333333, 0.5308971333333333, 0.5548638666666666, 0.5628122666666666, 0.5864964, 0.5947296666666667, 0.6180706, 0.6264656, 0.6493528, 0.6578744666666667, 0.6800286666666666, 0.6886520666666667, 0.7100469333333334, 0.7186637333333333, 0.7390778666666666, 0.7476264, 0.7668703333333333, 0.7752314666666666, 0.793365, 0.8014791333333333, 0.8183642, 0.8261444666666666, 0.8416633333333333, 0.8491074, 0.8632146, 0.8702104, 0.8829332, 0.8894125333333334, 0.9007723333333333, 0.9067491333333333, 0.9167785333333334, 0.9222275333333333, 0.9310186, 0.9359026666666667, 0.9434538, 0.947732, 0.9542112666666667, 0.9578733333333334, 0.9633472, 0.9665266666666666, 0.9710406666666667, 0.9737116666666666, 0.9774015333333333, 0.9796582666666667, 0.9826203333333333, 0.9844557333333334, 0.9868234, 0.9883219333333333, 0.9901728666666667, 0.9913298666666667, 0.9927825333333333, 0.9936726666666666, 0.9947540666666667, 0.9954672, 0.9962768666666667, 0.9967990666666666, 0.9973972666666666, 0.9977862666666667, 0.9982130666666666, 0.9984933333333333, 0.9987971333333333, 0.9989958666666666, 0.999204, 0.9993448, 0.9994823333333334, 0.9995772, 0.9996747333333333, 0.9997324666666667, 0.9997975333333333, 0.9998348666666667, 0.9998778666666667, 0.9998991333333334, 0.9999248666666667, 0.9999418, 0.9999562666666667, 0.9999672666666667, 0.9999754666666667, 0.9999816, 0.9999855333333333, 0.9999907333333333, 0.9999929333333333, 0.9999952, 0.9999960666666666, 0.999998, 0.9999979333333333, 0.9999988666666667, 0.9999988666666667, 0.9999994, 0.9999992666666667, 0.9999998, 0.9999996666666666, 0.9999999333333334, 0.9999998, 0.9999999333333334, 0.9999998, 0.9999999333333334, 0.9999999333333334, 1.0, 0.9999999333333334, 1.0, 0.9999999333333334, 1.0]

states_per_turn = [1, 225.0, 50400.0, 5619600.0, 623775600.0, 45951469200.0, 3369774408000.0, 184495148838000.0, 1.0054985611671e+16, 4.363863755465214e+17, 1.8851891423609725e+19, 6.755261093460151e+20, 2.4093764566674538e+22, 7.331388361002395e+23, 2.220363332189297e+25, 5.8562082886492705e+26, 1.5372546757704336e+28, 3.5698469692891176e+29, 8.250312995690406e+30, 1.707814790107914e+32, 3.518098467622303e+33, 6.556456235114291e+34, 1.2159246108757414e+36, 2.0569391333981292e+37, 3.462514207886851e+38, 5.3535796598865923e+39, 8.236276399825527e+40, 1.1707278596894856e+42, 1.6557436872751295e+43, 2.1745433759546704e+44, 2.841403344580769e+45, 3.4629603262078124e+46, 4.198839395526972e+47, 4.766917666686504e+48, 5.383812894140051e+49, 5.712823682115277e+50, 6.030202775566126e+51, 5.998464866221041e+52, 5.935323130787135e+53, 5.549527127285971e+54, 5.161060228375953e+55, 4.5466482964264355e+56, 3.9837299359164954e+57, 3.3137389921487214e+58, 2.7413658935048513e+59, 2.1573357683668613e+60, 1.6883497317653696e+61, 1.259227508275005e+62, 9.339270686372953e+62, 6.61220364595205e+63, 4.654991366750243e+64, 3.1331672660818947e+65, 2.0968119396086527e+66, 1.3435128353788773e+67, 8.558674358709886e+67, 5.22690469764068e+68, 3.1734778521389843e+69, 1.8493715759016838e+70, 1.0713600853499411e+71, 5.963904475114672e+71, 3.300027142896785e+72, 1.756466059928934e+73, 9.292272058978877e+73, 4.733251080042365e+74, 2.3962083592714475e+75, 1.1690592298263729e+76, 5.668165962794535e+76, 2.650701141424503e+77, 1.231796412779622e+78, 5.5254867658971615e+78, 2.462788387085592e+79, 1.0603672222174077e+80, 4.5360153394855777e+80, 1.8757036403818738e+81, 7.705593333460671e+81, 3.061959456190951e+82, 1.2086682063911649e+83, 4.617732378263681e+83, 1.7523702358539098e+84, 6.439960616763118e+84, 2.3505856251185382e+85, 8.313046722980196e+85, 2.9197042149003615e+86, 9.940897684065517e+86, 3.360970169374532e+87, 1.1020855671669977e+88, 3.588185567520458e+88, 1.1335404406485081e+89, 3.555195018397594e+89, 1.082359372267712e+90, 3.2711305472979736e+90, 9.600057040983183e+90, 2.7965383554168405e+91, 7.91360853766893e+91, 2.2225453765368061e+92, 6.065696756798367e+92, 1.642792871632891e+93, 4.324903682462101e+93, 1.1297707578676508e+94, 2.869617724983833e+94, 7.23143666695926e+94, 1.7724109477841322e+95, 4.309391324024165e+95, 1.0193367939518698e+96, 2.3915209396563096e+96, 5.459887428271953e+96, 1.2362009271559138e+97, 2.7242205616954396e+97, 5.9529264125937386e+97, 1.2663498004972135e+98, 2.6708468519577592e+98, 5.484774785270399e+98, 1.1165434384300453e+99, 2.213498395484125e+99, 4.349330180600386e+99, 8.323718104252463e+99, 1.578636192185812e+100, 2.916463473699212e+100, 5.338611104398558e+100, 9.520523136177428e+100, 1.6819590873913455e+101, 2.8951754782965785e+101, 4.936036881030232e+101, 8.200190302356676e+101, 1.3490635658715822e+102, 2.1627844468734887e+102, 3.432991185513474e+102, 5.310408240091156e+102, 8.131562617639582e+102, 1.2134793444785222e+103, 1.7922156472298175e+103, 2.5797043407095858e+103, 3.6741243640409255e+103, 5.099903967997105e+103, 7.00285320978707e+103, 9.371465324862108e+103, 1.2403409988788084e+104, 1.599860128988608e+104, 2.0404013239275e+104, 2.5359273597384644e+104, 3.115567899107256e+104, 3.729905231325588e+104, 4.4128456257936535e+104, 5.087030374178795e+104, 5.793562370592517e+104, 6.428473315314984e+104, 7.044902263358887e+104, 7.520909173045298e+104, 7.92744480402072e+104, 8.138843332127939e+104, 8.247361243222978e+104, 8.138843332127939e+104, 7.924663244440362e+104, 7.512992426547356e+104, 7.025135775472852e+104, 6.394674872545802e+104, 5.738810783053925e+104, 5.012379038363554e+104, 4.3144528431483755e+104, 3.6133542561367646e+104, 2.981017261312831e+104, 2.3921743454979508e+104, 1.890113063109492e+104, 1.452160036291439e+104, 1.09797466158621e+104, 8.069452332139615e+103, 5.833339035281649e+103, 4.097226227162111e+103, 2.829037156850029e+103, 1.897119034593549e+103, 1.2498666580851617e+103, 7.993333278451615e+102, 5.019069732981246e+102, 3.057594205149495e+102, 1.827527570893951e+102, 1.0591352967680852e+102, 6.017814186182302e+101, 3.313178596886886e+101, 1.7868828387704553e+101, 9.331499269134599e+100, 4.769432959779906e+100, 2.358510804286767e+100, 1.1403788504243708e+100, 5.330031583505211e+99, 2.4332752881219445e+99, 1.0727342668064485e+99, 4.6139108249739723e+98, 1.9142821507870737e+98, 7.738587418075404e+97, 3.013976152303052e+97, 1.1421383313990513e+97, 4.1640459998923747e+96, 1.4747662916285492e+96, 5.017246146777539e+95, 1.6551739865657862e+95, 5.2357544472999355e+94, 1.6027819736632455e+94, 4.695017902649911e+93, 1.3278838512545204e+93, 3.585286398387205e+92, 9.321744635806733e+91, 2.307362533615528e+91, 5.482841664036898e+90, 1.236327041890673e+90, 2.6665877374112557e+89, 5.436732280158871e+88, 1.055676170904635e+88, 1.928639158383468e+87, 3.3380293125867716e+86, 5.404428410854773e+85, 8.235319483207272e+84, 1.1653753985670669e+84, 1.5391750547112204e+83, 1.8700257674061556e+82, 2.0972251597078383e+81, 2.1360626626653907e+80, 1.9778357987642508e+79, 1.633075430172317e+78, 1.1985874716861043e+77, 7.627374819820663e+75, 4.160386265356726e+74, 1.8740478672778043e+73, 6.753325647847944e+71, 1.8089265128164133e+70, 3.2302259157435955e+68, 2.858607005082828e+66]

non_terminal_per_turn = [1.0, 225.0, 50400.0, 5619600.0, 623775600.0, 45951469200.0, 3369774408000.0, 184495148838000.0, 1.0054985611671e+16, 4.363863464540964e+17, 1.88518889100242e+19, 6.755256139602016e+20, 2.4093721197898317e+22, 7.331359524208175e+23, 2.2203506021061926e+25, 5.856151678635814e+26, 1.5372325393031025e+28, 3.569766290747612e+29, 8.250059986091872e+30, 1.7077364583362078e+32, 3.51788362907588e+33, 6.555887571810166e+34, 1.2157912644767487e+36, 2.056631963820875e+37, 3.4618664868956955e+38, 5.352260894763707e+39, 8.233735783098728e+40, 1.1702672173009599e+42, 1.654955884428724e+43, 2.1732605403324153e+44, 2.8394009129303982e+45, 3.4599683284859687e+46, 4.194545662361106e+47, 4.761039739408969e+48, 5.37604118076693e+49, 5.702998387091863e+50, 6.01814840021777e+51, 5.984338881358748e+52, 5.919234843908823e+53, 5.532048336645872e+54, 5.142499679511986e+55, 4.527732117744096e+56, 3.964932573422875e+57, 3.295803490311683e+58, 2.724664944208441e+59, 2.1424149150809135e+60, 1.6752898963635693e+61, 1.2482429309263198e+62, 9.248434449205107e+62, 6.5400393778008585e+63, 4.598688004838368e+64, 3.090881622903218e+65, 2.065574334269676e+66, 1.3213038516698856e+67, 8.403182645274007e+67, 5.121909423756979e+68, 3.103643779481145e+69, 1.804617400222055e+70, 1.0430561089511037e+71, 5.791276079333424e+71, 3.1962520693413478e+72, 1.6961483128445505e+73, 8.94634864703927e+73, 4.541574606505257e+74, 2.291314657838788e+75, 1.1135198756849095e+76, 5.3776724572013153e+76, 2.5038236706172583e+77, 1.1584146050811016e+78, 5.170571858121133e+78, 2.29308535606847e+79, 9.818039078118386e+79, 4.1765037669219243e+80, 1.7162625786039467e+81, 7.0066420789624545e+81, 2.7648842712693272e+82, 1.0837846589906888e+83, 4.1085144030412554e+83, 1.5470870722045678e+84, 5.636732664860969e+84, 2.039898223764162e+85, 7.145585163532568e+85, 2.4859541246164497e+86, 8.37563574560515e+86, 2.8021288876259846e+87, 9.083496514252266e+87, 2.9235863817393705e+88, 9.119765101771949e+88, 2.824407143403878e+89, 8.481182596850675e+89, 2.5278664450946264e+90, 7.307525659372037e+90, 2.096776969099236e+91, 5.83642135544988e+91, 1.612471339476938e+92, 4.3225962666578685e+92, 1.1498243533499665e+93, 2.968867038670866e+93, 7.60629083851722e+93, 1.8918402512321016e+94, 4.668065923002209e+94, 1.11839733424901e+95, 2.6582058061893304e+95, 6.134404163011209e+95, 1.404284673989066e+96, 3.121848973849909e+96, 6.88434939462444e+96, 1.4743568854953693e+97, 3.1310738016700363e+97, 6.459591236012263e+97, 1.3212157671216619e+98, 2.6252794066333246e+98, 5.1715850559761e+98, 9.897439676898911e+98, 1.8774069295982604e+99, 3.4596885050313234e+99, 6.318129325323638e+99, 1.121092447907942e+100, 1.970906667984825e+100, 3.3661713652582532e+100, 5.695631513306013e+100, 9.363281224008009e+100, 1.5246279346328497e+101, 2.4115688187698145e+101, 3.777850156688485e+101, 5.748819477994333e+101, 8.661118637200639e+101, 1.2675006296975172e+102, 1.8360108866241296e+102, 2.583537973706256e+102, 3.5976614303674857e+102, 4.863612902501835e+102, 6.507045707853467e+102, 8.454226405572076e+102, 1.086370358995733e+103, 1.3549245823754988e+103, 1.6716331979029468e+103, 2.0014666177281024e+103, 2.3691956740678254e+103, 2.7221929149294947e+103, 3.092855409122764e+103, 3.4078154815831856e+103, 3.710714816376542e+103, 3.918705673555482e+103, 4.086469906222863e+103, 4.1352568864893e+103, 4.1300974349016924e+103, 4.000296380051064e+103, 3.823507043280044e+103, 3.5449003427860976e+103, 3.2431703423216887e+103, 2.87361397064774e+103, 2.5117378646518618e+103, 2.125195159035833e+103, 1.7735564110281756e+103, 1.4323815927507695e+103, 1.1401831005032985e+103, 8.789306891351259e+102, 6.667440371725682e+102, 4.890674985681111e+102, 3.535506345365426e+102, 2.4669537155382166e+102, 1.6965654854470798e+102, 1.1287349530086098e+102, 7.379707295453235e+101, 4.661615019579294e+101, 2.8918194933505246e+101, 1.730040116998444e+101, 1.0211126713934496e+101, 5.800125261764011e+100, 3.2269057378442704e+100, 1.732581632548649e+100, 9.155452402255524e+99, 4.652639182169148e+99, 2.321325520549497e+99, 1.117811392209037e+99, 5.217846087032468e+98, 2.3539029538015694e+98, 1.0407996908224978e+98, 4.400112955372601e+97, 1.8355957651206266e+97, 7.358553709374712e+96, 2.8304203067532885e+96, 1.052503570022829e+96, 3.774821063639843e+95, 1.3094509616817381e+95, 4.438582213624961e+94, 1.4408163654924041e+94, 4.607039042894224e+93, 1.3743731254501915e+93, 4.00509841543934e+92, 1.1076362359713716e+92, 2.851214830481862e+91, 7.626214143101859e+90, 1.8537948649536804e+90, 4.36312870608328e+89, 9.189283315669274e+88, 1.846707041708965e+88, 3.983651553763561e+87, 6.931553703548596e+86, 1.3671892132516542e+86, 2.4611867025232298e+85, 3.2897049984221386e+84, 2.4726540837813457e+83, 1.7777251582741704e+82, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
term_per_turn = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 29092425036.43476, 1256792761573.9817, 450350739564010.06, 2.7306266508897812e+16, 2.0527887410806705e+18, 6.513065774421938e+19, 3.943180247690509e+21, 1.1785619180906659e+23, 5.330971474138416e+24, 1.2980492446552906e+26, 5.146215234191847e+27, 1.088265125984499e+29, 3.6585025791937746e+30, 6.549780570583993e+31, 1.963691226017414e+33, 3.171663014424356e+34, 8.283772260397855e+35, 1.2656411401065227e+37, 2.8066249222955936e+38, 3.9075551019693053e+39, 7.694984159711593e+40, 9.963854394996564e+41, 1.7762677833228605e+43, 2.1380490202023345e+44, 3.4480704455699047e+45, 3.874191758623181e+46, 5.71015769773029e+47, 6.020956464643591e+48, 8.127919893729511e+49, 8.035636142668342e+50, 9.95252195007466e+51, 9.286811774939691e+52, 1.0715843814904252e+54, 9.385402147023536e+54, 1.010381110299426e+56, 8.315111028178914e+56, 8.34845795642608e+57, 6.496657211184358e+58, 6.111450840161358e+59, 4.5259973600300605e+60, 3.989627354536908e+61, 2.8019634367500848e+62, 2.325812724957912e+63, 1.5534440935784665e+64, 1.2145714301914484e+65, 7.727627078479156e+65, 5.717676202717822e+66, 3.4660513535871845e+67, 2.4225164855612943e+68, 1.4038531166380109e+69, 9.293194509302686e+69, 5.1332362211378545e+70, 3.2339116313512904e+71, 1.707114274195206e+72, 1.0220256617077878e+73, 5.166081450087685e+73, 2.9464890891261917e+74, 1.4270363566796946e+75, 7.742150222531747e+75, 3.59326510374335e+76, 1.8600261917147418e+77, 8.281109532986057e+77, 4.090189831833281e+78, 1.7464505779882845e+79, 8.246368493956742e+79, 3.3773410098069234e+80, 1.5257968513892964e+81, 6.00285064704172e+81, 2.595433425062128e+82, 9.800831492107332e+82, 4.061258123591793e+83, 1.472021339531733e+84, 5.854707004029344e+84, 2.0378640044045288e+85, 7.775133951024266e+85, 2.6028338876219394e+86, 9.518191389786233e+86, 3.0653677933430333e+87, 1.0761047022144753e+88, 3.3335712713407245e+88, 1.1230438179254256e+89, 3.351635250820675e+89, 1.083980840725575e+90, 3.114232570027808e+90, 9.678944675817965e+90, 2.675587544393151e+91, 7.992166090555366e+91, 2.1281023609896886e+92, 6.105596275642222e+92, 1.5658795935561847e+93, 4.317791353760241e+93, 1.066679814900715e+94, 2.8282786872418865e+94, 6.7255090283893e+94, 1.7163776417184495e+95, 3.929592556355817e+95, 9.646878541066295e+95, 2.1256087599488761e+96, 5.021951681428171e+96, 1.065406352191205e+97, 2.420455420077556e+97, 4.94539878971573e+97, 1.0808260626688613e+98, 2.126175609543537e+98, 4.467862398345678e+98, 8.464454730082349e+98, 1.7106350533319377e+99, 3.120106026286929e+99, 6.062971753276871e+99, 1.0647411404390154e+100, 1.9890429264472065e+100, 3.3622664909588725e+100, 6.037560340099974e+100, 9.820939710664245e+100, 1.694564405867826e+101, 2.6522113035908696e+101, 4.396864362110013e+101, 6.620365583668201e+101, 1.0541447118625909e+102, 1.5264195293952613e+102, 2.334333810592999e+102, 3.247337037803473e+102, 4.772470228341672e+102, 6.376168499173845e+102, 8.99384724442585e+102, 1.154341919677449e+103, 1.5628617788253142e+103, 1.924773565470124e+103, 2.499520141056965e+103, 2.954662988885385e+103, 3.677818256227418e+103, 4.170457648839651e+103, 4.975837801590613e+103, 5.4077687424821745e+103, 6.180111112860838e+103, 6.43671345410182e+103, 7.04099968104258e+103, 7.0245659788253245e+103, 7.348199014795486e+103, 7.020080041678914e+103, 7.018471862609426e+103, 6.4117515495596686e+103, 6.126926686321467e+103, 5.351720563997273e+103, 4.880735391320607e+103, 4.072864616645039e+103, 3.5409147909416236e+103, 2.8185289209982617e+103, 2.333870611014889e+103, 1.7729150964197986e+103, 1.3995605040294528e+103, 1.011419409866626e+103, 7.610479410596151e+102, 5.231228122506879e+102, 3.7321287418042673e+102, 2.441690692097568e+102, 1.655163025289373e+102, 1.029063228106726e+102, 6.604428214928664e+101, 3.895659605973339e+101, 2.368919891036734e+101, 1.324208726908067e+101, 7.602086258915669e+100, 4.016761507304891e+100, 2.1857110255704327e+100, 1.0868793804791898e+100, 5.58369067554156e+99, 2.6351205946067474e+99, 1.2664072990167308e+99, 5.612003368965076e+98, 2.5469394105175973e+98, 1.0577966380397193e+98, 4.485258613538954e+97, 1.7547389497763267e+97, 6.978077349125022e+96, 2.549423628541632e+96, 9.462231389410747e+95, 3.2288147953167856e+95, 1.1101560286464502e+95, 3.545304849134278e+94, 1.1368718046487112e+94, 3.314485437720047e+93, 1.0032574829074028e+93, 2.70078866873575e+92, 7.52252438940179e+91, 1.8361396757636457e+91, 4.844818115234874e+90, 1.1123306897222925e+90, 2.5478297151713516e+89, 5.4089135541100795e+88, 1.1042682107032594e+88, 2.15021576265942e+87, 3.999428391600248e+86, 7.602873774131165e+85, 1.120936517980877e+85, 1.8666114161878789e+84, 2.609631494476258e+83, 4.1523262722248983e+82, 3.857278316766936e+81, 6.898593912679328e+80, 6.125018865635409e+79, 9.333362080968242e+78, 6.992252391402401e+77, 1.128728373454895e+77, 3.740051534812311e+75, 6.990750532359461e+74, 1.4240417751102604e+73, 3.955671597528502e+72, 1.0887169534482114e+71, 2.3971749433722085e+70, 5.084916546547109e+68, 2.7735908435711505e+67, 0.0, 4.502217098565296e+64, 0.0, 2.1534839438290637e+61, 0.0]
illegal_per_turn = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1256792761573.9817, 45035073956401.01, 1.606250971111636e+16, 8.308906809136049e+17, 6.2170173301300314e+19, 1.717821098003786e+21, 1.0350848150187586e+23, 2.7368826764549906e+24, 1.2320467406897673e+26, 2.686961936436452e+27, 1.0601203382435206e+29, 2.0281304620620206e+30, 6.784859328686637e+31, 1.1080045465237922e+33, 3.3055468971293136e+34, 4.903878968456119e+35, 1.2749755866929916e+37, 1.799798962962636e+38, 3.9704733620857604e+39, 5.133372062836992e+40, 1.006046210871231e+42, 1.2157299385206893e+43, 2.1556841456635477e+44, 2.4298568319656673e+45, 3.8975216144977874e+46, 4.115137325683705e+47, 6.033418883713095e+48, 5.998064968563293e+49, 8.052650735643265e+50, 7.526268690025234e+51, 9.273737089027804e+52, 8.200334867434719e+53, 9.411960346596312e+54, 7.831690734044288e+55, 8.38583826823134e+56, 6.572395329521922e+57, 6.563178190615913e+58, 4.873126508523717e+59, 4.557626356754577e+60, 3.2267994605822404e+61, 2.8283727544374478e+62, 1.9027515929097607e+63, 1.570316440319184e+64, 1.0063269407077225e+65, 7.821544265108732e+65, 4.781851185652235e+66, 3.5173559121967646e+67, 2.052901082401584e+68, 1.4265445232457226e+69, 7.969645068822071e+69, 5.244271134405855e+70, 2.797863077087066e+71, 1.7521198452008603e+72, 8.947390736632885e+72, 5.3232886931782866e+73, 2.6074463250201454e+74, 1.4778986992525044e+75, 6.9455968581927405e+75, 3.7449156661086926e+76, 1.6891228860455425e+77, 8.689193568726139e+77, 3.766141608723641e+78, 1.8486651476482524e+79, 7.697737683835979e+79, 3.6121715351752484e+80, 1.4449549978269428e+81, 6.485504093005883e+81, 2.496746327162129e+82, 1.072748487282688e+83, 3.9710213954297075e+83, 1.6348526740120278e+84, 5.81990859044695e+84, 2.2996368984345886e+85, 7.877485433579406e+85, 2.985578929863531e+86, 9.855400184390877e+86, 3.5806240644678365e+87, 1.1395346024986575e+88, 3.974307478596437e+88, 1.2193673079010183e+89, 4.081005771212799e+89, 1.2085505408855704e+90, 3.883381293148234e+90, 1.109292714637255e+91, 3.4251528262055304e+91, 9.438838810849615e+91, 2.8015828218395566e+92, 7.454770162270126e+92, 2.125537146603104e+93, 5.459983383757072e+93, 1.496690929056336e+94, 3.711857448109337e+94, 9.786346149959041e+94, 2.342586134789039e+95, 5.942770100316619e+95, 1.3733506003154143e+96, 3.3520511169858215e+96, 7.476685080572532e+96, 1.7564462587324973e+97, 3.783451348882316e+97, 8.550912058645243e+97, 1.7786693159682128e+98, 3.867673718780816e+98, 7.769681879596662e+98, 1.6254777779938907e+99, 3.153394545889202e+99, 6.348126570247552e+99, 1.189073850463583e+100, 2.3029632959747176e+100, 4.165308844471969e+100, 7.76169286964857e+100, 1.3550913218857803e+101, 2.4293149753309582e+101, 4.094057077719036e+101, 7.060574198436467e+101, 1.148216062863054e+102, 1.9048427634265902e+102, 2.9887628985310473e+102, 4.769132201620192e+102, 7.216921660485967e+102, 1.1077158004127217e+103, 1.616096027625235e+103, 2.3858029433381942e+103, 3.3550966029973128e+103, 4.7621409311138874e+103, 6.453678963661296e+103, 8.807003225415014e+103, 1.1497614531101012e+104, 1.508015457632179e+104, 1.8959262426227732e+104, 2.3892365933110145e+104, 2.891539903008208e+104, 3.5009972699077816e+104, 4.077148695537163e+104, 4.7412440345600485e+104, 5.310847658561796e+104, 5.929435921986185e+104, 6.386059633560642e+104, 6.843086095524824e+104, 7.082506111588387e+104, 7.281869054034842e+104, 7.238789266431019e+104, 7.138317401575448e+104, 6.812399371511713e+104, 6.44049367270553e+104, 5.897345234176563e+104, 5.342939580903769e+104, 4.6910989083485526e+104, 4.070486929789139e+104, 3.424491455877008e+104, 2.844520256872514e+104, 2.291400014236607e+104, 1.8208351270299524e+104, 1.4035513993433101e+104, 1.066178047369781e+104, 7.857319879414885e+103, 5.701514517537471e+103, 4.01388154384284e+103, 2.7798694340763613e+103, 1.867629710421418e+103, 1.2333976650782367e+103, 7.899986599536971e+102, 4.969746665505942e+102, 3.0310844557116217e+102, 1.8143374515686096e+102, 1.0524337947003346e+102, 5.986245134149202e+101, 3.298160620942917e+101, 1.780230035710668e+101, 9.301629762074049e+100, 4.757019397634388e+100, 2.3532896903022907e+100, 1.138341069443919e+100, 5.322001002586063e+99, 2.430348382387039e+99, 1.0716570985713393e+99, 4.6102381519572927e+98, 1.913027913121878e+98, 7.73458140932198e+97, 3.0127018431858585e+97, 1.141766831871125e+97, 4.1629319787858704e+96, 1.474467700613371e+96, 5.0164176321971677e+95, 1.6549718346495603e+95, 5.235226334201351e+94, 1.6026615513109577e+94, 4.694744652607977e+93, 1.3278257784674257e+93, 3.585169040012431e+92, 9.321515942338335e+91, 2.3073200781449096e+91, 5.482762345594158e+90, 1.2363155852600847e+90, 2.666568893524578e+89, 5.436706183843926e+88, 1.0556720185783628e+88, 1.9286353011051513e+87, 3.338022413992859e+86, 5.404422285835907e+85, 8.235310149845191e+84, 1.1653746993418278e+84, 1.539173925982847e+83, 1.870025393401002e+82, 2.097224460632785e+81, 2.1360625202612132e+80, 1.977835403197091e+79, 1.6330753213006217e+78, 1.1985872319686098e+77, 7.62737431132901e+75, 4.1603859879976415e+74, 1.8740478672778043e+73, 6.753325197626234e+71, 1.8089265128164133e+70, 3.230225700395201e+68, 2.858607005082828e+66]

def plot_proportions(nonterm_prop: List[float], term_prop: List[float], illegal_prop: List[float], m:int, n:int, k:int):
    plt.title(label=f"m={m}, n={n}, k={k}")
    plt.plot(nonterm_prop)
    plt.plot(term_prop)
    plt.plot(illegal_prop)
    labels = ["Non Terminal", "Terminal", "Illegal"]
    plt.legend(labels=labels)
    plt.ylabel("Proportion of States")
    plt.xlabel("Turn")
    plt.show()


def plot_log_states(statespt: List[float], non_termpt: List[float], termpt: List[float], illegalpt: List[float], m:int, n:int, k:int):
    plt.title(label=f"m={m}, n={n}, k={k}")
    plt.plot(statespt, linestyle='dashed')
    plt.plot(non_termpt)
    plt.plot(termpt)
    plt.plot(illegal_per_turn)
    plt.yscale("log")
    labels = ["Possible States", "Non Terminal", "Terminal", "Illegal"]
    plt.legend(labels=labels)
    plt.ylabel("Log(States)")
    plt.xlabel("Turn")
    plt.show()


def plot_states(statespt: List[float], non_termpt: List[float], termpt: List[float], illegal_pt: List[float], m:int, n:int, k:int):
    plt.title(label=f"m={m}, n={n}, k={k}")
    plt.plot(statespt)
    plt.plot(non_termpt)
    plt.plot(termpt)
    plt.plot(illegal_pt)
    labels = ["Possible States", "Non Terminal", "Terminal", "Illegal"]
    plt.legend(labels=labels)
    plt.ylabel("States")
    plt.xlabel("Turn")
    plt.show()

def results_to_dicts(filepath:str) -> List:
    with open(filepath, newline='') as csvfile:
        res_reader = csv.DictReader(csvfile)
        results = []
        for row in res_reader:
            results.append(row)
        return results

def variables_by_k(k: int, variable1: str, variable2: str, results: List[Dict]) -> Tuple[List, List]:
    var1 = []
    var2 = []
    for result in results:
        if result["k"] == str(k):
            var1.append(float(result[variable1]))
            var2.append(float(result[variable2]))
    return var1, var2



if __name__ == "__main__":
    # headers:
    # m,n,k,mn,nonterm_mean,nonterm_sterror,term_mean,term_sterror,illegal_mean,illegal_sterror


    # plot_proportions(nonterm_prop, term_prop, illegal_prop, 15, 15, 5)
    # plot_log_states(states_per_turn, non_terminal_per_turn, term_per_turn, illegal_per_turn, 15, 15, 5)
    # plot_states(states_per_turn, non_terminal_per_turn, term_per_turn, illegal_per_turn, 15, 15, 5)
    results = results_to_dicts("resulttable.csv")
    nonterms_by_k = []
    terms_by_k = []
    illegal_by_k = []
    for k in range(3,10):
        nonterms_by_k.append(variables_by_k(k, "mn", "nonterm_mean", results))
        terms_by_k.append(variables_by_k(k, "mn", "term_mean", results))
        illegal_by_k.append(variables_by_k(k, "mn", "illegal_mean", results))
    # for i in range(len(nonterms_by_k)):
    #     plt.scatter(nonterms_by_k[i][0], nonterms_by_k[i][1], label=f'{i+3}')
    # for i in range(len(terms_by_k)):
    #     plt.scatter(terms_by_k[i][0], terms_by_k[i][1], label=f'{i+3}')
    for i in range(len(illegal_by_k)):
        plt.scatter(illegal_by_k[i][0], illegal_by_k[i][1], label=f'{i+3}')

    plt.title(label="Illegal States by k")
    plt.ylabel("Illegal States")
    plt.xlabel("m*n")
    plt.yscale("log")
    plt.legend()

    plt.show()
